# This is the shell file where I keep all my usual aliases and short,
# general-purpose shell functions.
if ls --color=auto -d . >/dev/null 2>&1
then
    alias ls='ls --color=auto'
    alias less='less -R'
fi

if test -n "${TMUX-}" && command -v wtitle >/dev/null 2>&1
then
    alias vim='wtitle vim'
    alias man='wtitle man'
    alias ssh='wtitle ssh'
else
    : # alias vim='emacsclient -n'
fi

alias en='LC_ALL=en_US.utf8 LANGUAGE=en'
alias c='LC_ALL=C'
alias a='printf \\a'
alias aa='printf \\a; sleep 1; printf \\a'
alias asa='printf \\a; sleep 1; printf \\a'
alias glog='git log --pretty=oneline --abbrev-commit'
alias bobcfg="./configure --prefix=$HOME/opt/bobbin CFLAGS='-Werror -O3'"

alias mcn='ssh micah.cowan.name'

# Edit a new file, after first creating it with executable permissions.
# Useful for starting a new script file.
viscr() {
    for n in "$@"; do
        touch "$n"
        chmod +x "$n"
    done
    ${VISUAL:-$EDITOR} "$@"
}

# When in nvim terminal-mode, make nvim and vim open files in
# current session
vim_open() {
    if test "x$NVIM" != x; then
        nvim --server "$NVIM" --remote-send '<C-\><C-N><C-W>w'

        # Fixup relative args to use absolute paths
        mjc_vim_ts=
        for arg; do
            if test "${arg#/}" = "$arg"; then
                arg="${PWD}/${arg}"
            fi
            mjc_vim_ts="${mjc_vim_ts}${mjc_vim_ts+ }$(printf '%s\n' "$arg" | sed -e "s/'/'\\\\''/g" -e "s/^/'/" -e "s/\$/'/")"
        done
        eval "set -- $mjc_vim_ts"
        echo "$@"
        unset mjc_vim_ts
        nvim --server "$NVIM" --remote '<C-A><Tab>'
        nvim --server "$NVIM" --remote "$@"
    else
        command vim "$@"
    fi
}
alias vim=vim_open
alias v=vim

alias teseq='teseq --color=auto'
ceseq() { teseq --color=always "$@" | \less -r; }

# git-all-status, show the behind/ahead of all branches
alias gas='git for-each-ref --format="%(refname:short) %(upstream:track)" refs/heads'
# git-commit-id
alias gcid='git rev-parse --short HEAD'

# vim: set ft=sh :
